<html>

	<head>
		<title>选中表格中的单元格</title>
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<style type="text/css">
			.STYLE3 {
				font-size: 13px;
				color: #FF0000;
			}
			
			.STYLE4 {
				font-size: 12px
			}
			
			.table1 {
				width: 547;
				height: 200;
				border: 0;
				margin: 0 auto;
			}
			
			.table2 {
				width: 500;
				border: 1;
				margin: 0 auto;
				border-color: #FFFFFF;
				background-color: #CCCCCC;
			}
		</style>

	</head>

	<body>
		<table class="table1">
			<tr>
				<td height="34"><img src="images/bg.jpg" width="547" height="34"></td>
			</tr>
			<tr>
				<td align="center" valign="top" background="images/bg2.jpg">
					<table id="table1" class="table2">
						<tr>
							<td width="113" height="24" align="center" bgcolor="#FFFFFF"><span class="STYLE3">商品名称</span></td>
							<td width="83" align="center" bgcolor="#FFFFFF"><span class="STYLE3">数量</span></td>
							<td width="139" align="center" bgcolor="#FFFFFF"><span class="STYLE3">价格</span></td>
							<td width="142" align="center" bgcolor="#FFFFFF"><span class="STYLE3">合计</span></td>
						</tr>
						<tr>
							<td height="20" align="center" bgcolor="#FFFFFF" class="STYLE4">手机</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">1</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">888</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">888</td>
						</tr>
						<tr>
							<td height="20" align="center" bgcolor="#FFFFFF" class="STYLE4">手表</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">1</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">999</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">999</td>
						</tr>
						<tr>
							<td height="20" align="center" bgcolor="#FFFFFF" class="STYLE4">数码相机</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">2</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">2400</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">4800</td>
						</tr>
						<tr>
							<td height="20" align="center" bgcolor="#FFFFFF" class="STYLE4">手机</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">4</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">2400</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">9600</td>
						</tr>
						<tr>
							<td height="20" align="center" bgcolor="#FFFFFF" class="STYLE4">移动硬盘</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">4</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">400</td>
							<td align="center" bgcolor="#FFFFFF" class="STYLE4">1600</td>
						</tr>
						<tr>
							<td height="20" align="center" bgcolor="#FFFFFF"><span class="STYLE4">笔记本电脑</span></td>
							<td align="center" bgcolor="#FFFFFF"><span class="STYLE4">2</span></td>
							<td align="center" bgcolor="#FFFFFF"><span class="STYLE4">4150</span></td>
							<td align="center" bgcolor="#FFFFFF"><span class="STYLE4">9200</span></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td height="27"><img src="images/bg1.jpg" width="547" height="27"></td>
			</tr>
		</table>
		<script>
			var lastSelection = null;

			function select(element) {
				var e, r, c;
				if(element == null) {
					e = event.srcElement; //获取body元素的原始记录
				} else {
					e = element;
				}
				if(e.tagName == "td") {
					c = findcell(e);
					if(c != null) {
						if(lastSelection != null) {
							deselectroworcell(window.lastSelection);
						}
						selectroworcell(c);
						lastSelection = c;
					}
				}
				window.event.cancelBubble = true; //取消冒泡语句,用于防止向下一个外层对象冒泡
			}
			table1.onclick = select;

			function findcell(e) {
				if(e.tagName == "td") {
					return e;
				} else if(e.tagName == "body") {
					return null;
				} else {
					return findcell(e.parentElement);
				}
			}

			function selectroworcell(r) {
				r.runtimeStyle.backgroundColor = "darkblue";
				r.runtimeStyle.color = "white";
			}

			function deselectroworcell(r) {
				r.runtimeStyle.backgroundColor = "";
				r.runtimeStyle.color = "";
			}
		</script>
	</body>

</html>